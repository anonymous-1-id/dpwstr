<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>DPW OFFICIAL STORE</title>
  <link rel="icon" type="image/png" href="https://files.catbox.moe/bt2fdl.png">
  <style>
    :root { --accent:#7c3aed; --accent2:#ec4899; --muted:#94a3b8; --card:#1e293b; --bg:#0f172a; --text:#f8fafc; }
    body { margin:0;font-family:Inter,Arial,Helvetica,sans-serif;background:var(--bg);color:var(--text); }
    header { display:flex;align-items:center;gap:12px;padding:16px 22px;background:linear-gradient(90deg,var(--accent),var(--accent2));color:white;position:sticky;top:0;z-index:10;box-shadow:0 2px 10px rgba(0,0,0,.3);}
    header img {width:40px;height:40px;border-radius:10px;}
    header h1 {font-size:20px;margin:0;font-weight:700;}
    main {max-width:1100px;margin:0 auto;padding:24px;display:none;}
    .grid {display:grid;grid-template-columns:repeat(auto-fit,minmax(230px,1fr));gap:18px;}
    .card {background:var(--card);padding:18px;border-radius:14px;box-shadow:0 6px 18px rgba(0,0,0,.3);transition:.3s;}
    .card:hover {transform:translateY(-6px) scale(1.02);box-shadow:0 10px 25px rgba(124,58,237,.4);}
    
    /* CARD CONTENT FLEX */
    .card-content { display:flex; align-items:center; gap:12px; }
    .product-info { display:flex; flex-direction:column; gap:6px; }
    .product-logo { width:50px; height:50px; object-fit:contain; border-radius:10px; }

    .product-title {font-weight:600;font-size:16px;}
    .price {font-weight:700;color:var(--accent);}
    .btn {display:inline-block;background:linear-gradient(90deg,var(--accent),var(--accent2));color:white;padding:12px 16px;border:none;border-radius:10px;cursor:pointer;font-weight:600;font-size:14px;transition:.3s;box-shadow:0 4px 10px rgba(236,72,153,.3);}
    .btn:hover {opacity:.9;transform:translateY(-2px);}
    
    .form-row {margin-bottom:14px;}
    label {display:block;font-size:14px;color:var(--muted);margin-bottom:6px;}
    input[type=text],input[type=number], select {width:100%;padding:12px;border-radius:10px;border:1px solid #334155;font-size:14px;background:#0f172a;color:var(--text);}
    input:focus,select:focus {outline:2px solid var(--accent);}
    .total-box {display:flex;justify-content:space-between;align-items:center;padding:14px;border-radius:12px;background:rgba(124,58,237,0.1);margin-top:14px;}
    .back-link {cursor:pointer;color:var(--accent);font-size:14px;font-weight:600;}
    footer {margin-top:40px;text-align:center;font-size:13px;color:var(--muted);padding:18px;background:#1e293b;}
    .socials {margin-top:10px;display:flex;justify-content:center;gap:16px;}
    .socials a {color:var(--accent);font-weight:600;text-decoration:none;transition:.3s;}
    .socials a:hover {color:var(--accent2);}
    .izinkan {background:var(--accent);border:none;padding:10px 18px;border-radius:10px;color:white;font-weight:600;cursor:pointer;transition:.3s;}
    .izinkan:hover {background:var(--accent2);}
    .allert {margin-top:18px;display:flex;gap:12px;}
    .popup {position:fixed;top:0;left:0;width:100%;height:100%;background:#0f172a;opacity:0.95;color:white;display:flex;flex-direction:column;justify-content:center;align-items:center;z-index:9999;text-align:center;padding:20px;}
    .selamat {margin-bottom:10px;font-size:20px}

    /* LOADING */
    .loading { position: fixed; top:0; left:0; width:100%; height:100%; background:rgba(15,23,42,0.9); display:none; justify-content:center; align-items:center; z-index:99999; color:white; font-size:18px; flex-direction:column;}
    .loader { border:6px solid #334155; border-top:6px solid var(--accent); border-radius:50%; width:50px; height:50px; animation:spin 1s linear infinite; margin-bottom:10px; }
    @keyframes spin { from{transform:rotate(0deg);} to{transform:rotate(360deg);} }
  </style>
</head>
<body>

  <!-- POPUP -->
  <div class="popup" id="popup">
    <h2 class="selamat">üéµ Selamat Datang</h2>
    <p>Izinkan memutar musik di website ini?</p>
    <div class="allert">
      <button class="izinkan" onclick="playMusic()">Izinkan</button>
    </div>
  </div>

  <audio id="bgm" loop>
    <source src="https://files.catbox.moe/3gsfnm.mp3" type="audio/mpeg">
  </audio>

  <!-- LOADING -->
  <div class="loading" id="loading">
    <div class="loader"></div>
    <div>Sedang memuat produk...</div>
  </div>

  <header>
    <img src="https://files.catbox.moe/bt2fdl.png" alt="Logo">
    <h1>DPW OFFICIAL STORE</h1>
  </header>

  <main id="app"></main>

  <footer>
    ¬© 2025 DPW OFFICIAL STORE
    <div class="socials">
      <a href="https://www.tiktok.com/@dpw_official_store">TikTok</a>
      <a href="https://www.instagram.com/dpw_official_store">Instagram</a>
    </div>
  </footer>

<script>
function playMusic(){
  document.getElementById("bgm").play();
  document.getElementById("popup").style.display="none";
  document.getElementById("loading").style.display = "flex";
  fetchDataProduk();
}

const app = document.getElementById('app');
let PRODUCTS = [];

function fetchDataProduk(){
  fetch('https://script.google.com/macros/s/AKfycbyLB92zVhQN0pEahWhKuN4aM4SIH2whehjrj_3_9GSXjV1T4d-P2L9mx1LxhYl3mp3x7w/exec')
    .then(res => res.json())
    .then(data => {
      PRODUCTS = data.map(p => ({
        id: p.id,
        name: p.name,
        price: Number(p.price),
        image: p.image // pastikan di Sheet ada kolom image
      }));
      renderList();
      document.querySelector('main').style.display = 'block';
    })
    .catch(() => {
      app.innerHTML = "<p style='text-align:center;color:red'>Gagal memuat data produk</p>";
    })
    .finally(() => {
      document.getElementById("loading").style.display = "none";
    });
}

const rupiah = n => new Intl.NumberFormat('id-ID',{style:'currency',currency:'IDR'}).format(n);

function renderList(){
  app.innerHTML = `<div class="grid">
    ${PRODUCTS.map(p => `
      <div class="card">
        <div class="card-content">
          <img src="${p.image}" alt="Logo ${p.name}" class="product-logo">
          <div class="product-info">
            <div class="product-title">${p.name}</div>
            <div class="price">${rupiah(p.price)}</div>
            <button class="btn" onclick="renderForm('${p.id}')">Order</button>
          </div>
        </div>
      </div>
    `).join('')}
  </div>`;
}

function renderForm(pid){
  const p = PRODUCTS.find(x => x.id === pid);
  app.innerHTML = `
    <div class="card">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:14px">
        <div>
          <div class="product-title">Order: ${p.name}</div>
          <div style="font-size:14px;color:var(--muted)">Harga satuan: ${rupiah(p.price)}</div>
        </div>
        <span class="back-link" onclick="renderList()">‚Üê Kembali</span>
      </div>
      <div class="form-row">
        <label>Nama Produk</label>
        <input type="text" id="productName" value="${p.name}" readonly>
      </div>
      <div class="form-row">
        <label>Jumlah</label>
        <input type="number" id="qty" value="1" min="1">
      </div>
      <div class="form-row">
        <label>Nama Lengkap</label>
        <input type="text" id="buyer" placeholder="Nama lengkap">
      </div>
      <div class="form-row">
        <label>Metode Pembayaran</label>
        <select id="payment">
          <option value="gopay">GoPay</option>
          <option value="qris">QRIS (+Rp1.000)</option>
        </select>
      </div>
      <div class="total-box">
        <div>
          <div style="font-size:13px;color:var(--muted)">Total</div>
          <div id="total">${rupiah(p.price)}</div>
        </div>
        <button class="btn" onclick="submitOrder('${p.id}')">Order</button>
      </div>
    </div>
  `;

  function updateTotal(){
    const q = parseInt(document.getElementById('qty').value)||1;
    const pay = document.getElementById('payment').value;
    let total = q*p.price;
    if(pay==='qris') total+=1000;
    document.getElementById('total').textContent = rupiah(total);
  }
  document.getElementById('qty').addEventListener('input',updateTotal);
  document.getElementById('payment').addEventListener('change',updateTotal);
}

function submitOrder(pid){
  const p = PRODUCTS.find(x => x.id===pid);
  const qty = Math.max(1,parseInt(document.getElementById('qty').value)||1);
  const buyer = document.getElementById('buyer').value.trim();
  const payment = document.getElementById('payment').value;
  if(!buyer){ alert("Isi Semua Kolom!"); return; }

  const message = `‚îè‚îÅüöÄ Pesanan Baru ‚îÅ‚îì
‚îÉ Nama    : ${buyer}
‚îÉ Produk  : ${p.name}
‚îÉ Jumlah  : ${qty}
‚îÉ Payment : ${payment.toUpperCase()}
‚îó‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îõ

Mohon info selanjutnya ya! üòä`;

  window.open(`https://wa.me/6285786335575?text=${encodeURIComponent(message)}`,"_blank");
}
</script>
</body>
</html>
